<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>CTF Writeups - (web) LEENODE [250]</title>
        <!-- <link rel="stylesheet" type="text/css" href="/css/default.css" /> -->
        <link rel="stylesheet" type="text/css" href="../../../css/spring.css" />
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
      <div id="layout">
        <div id="header">
          <h1 id="logo"><a href="../../../"><span>CTF</span> WriteUps</a></h1>

          <div id="navigation">
            <ul>
              <li id="first"><a href="../../../">Home</a></li>
              <li><a href="../">Up</a></li>
              <li><a href="index.html">Contents of Current Dir</a></li>
            </ul>
          </div>
        </div>

        <div id="main">
          <div id="main-box"><h1 id="quote">(web) LEENODE [250]</h1></div>

          <div id="content">
            <h2 id="description">Description</h2>
<p>http://203.66.57.98/</p>
<h3 id="hint">Hint</h3>
<p>(none)</p>
<h2 id="solution">Solution</h2>
<h3 id="writeups">WriteUps</h3>
<ul>
<li>https://github.com/ctfs/write-ups/tree/master/hitcon-ctf-2014/leenode</li>
</ul>
<h3 id="my-notes">My Notes</h3>
<ol style="list-style-type: decimal">
<li><p>When failing a login, you are presented a page that says <code>Apache/2.0.65    (Unix) JRun/4.0 Server</code>.</p></li>
<li><p>When looking for JRun vulnerabilities, there are things like <a href="http://www.cvedetails.com/cve/CVE-2004-0928/">CVE-2004-0928</a>.</p></li>
<li><p>The vulnerability says that you should be able to access a page like http://203.66.57.98/a;.jsp in order to see the jsp source, but you can tell this error page is handled by apache.</p></li>
<li><p>However, you can use a double escaping trick. http://203.66.57.98/a%253b.jsp</p></li>
<li><p>Apache blocks attempts to read .htaccess.</p></li>
<li><p>JRun apparently accepts ’' as a slash operator, so we can use a url like the following to read .htaccess and .htpasswd:</p></li>
</ol>
<p>http://203.66.57.98/.%5Cadmin%5C.htaccess%253b.jsp</p>
<p>Apparently Apache hands this off to JRun because it ends with .jsp, and JRun is fooled by the ’'. This lets you read the .htaccess and .htpasswd files.</p>
<ol style="list-style-type: decimal">
<li>Also, apparently forward slashes can be double encoded and they will be passed to JRun as is:</li>
</ol>
<p>http://203.66.57.98/admin%252f%252ehtpasswd%2500.jsp</p>
<p>In the above url, it also looks like they are appending %25%00.jsp to the end of the file. I think there is a separate exploit that works for this.</p>
<ol style="list-style-type: decimal">
<li>The .htpasswd file can be cracked with John.</li>
</ol>
<h3 id="takeaways">Takeaways</h3>
<ul>
<li><p>If a funny/old web/application server is being used, check for vulnerabilities.</p></li>
<li><p>500 errors are often returned by Apache.</p></li>
<li><p>Check for double encoding errors. (For instance, ‘;’ actually double encoded as ‘%253b’ instead of ‘%3b’. Also ‘/’ being double encoded.)</p></li>
<li><p>I guess there are some web/application servers that will accept a backslash as a path name. Check for this as well: %5C</p></li>
<li><p>Also embedding %00 in urls. In this challenge it is actually double encoded.</p></li>
<li><p>Check for .htaccess files. Getting a .htpasswd file basically means you can crack it with John.</p></li>
</ul>
          </div>
          <div id="footer">
              Site proudly generated by
              <a href="http://jaspervdj.be/hakyll">Hakyll</a>
          </div>
        </div>
      </div>
    </body>
</html>
